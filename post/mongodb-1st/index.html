<html>
<head>
    <meta charset="utf-8"/>
<meta name="description" content=""/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>MongoDB 与 Python Mongodb | 雪中明月 の BLOG</title>

<link rel="shortcut icon" href="https://blog.xn--fiqz59cpva341l.top/favicon.ico?v=1715590005923">

<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://blog.xn--fiqz59cpva341l.top/styles/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css">

<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dockerfile.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dart.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/moment@2.27.0/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"></script>
<!-- DEMO JS -->
<!--<script src="media/scripts/index.js"></script>-->



    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.css">
</head>
<body>
<div class="main gt-bg-theme-color-first">
    <nav class="navbar navbar-expand-lg">
    <div class="navbar-brand">
        <img class="user-avatar" src="/images/avatar.png" alt="头像">
        <div class="site-name gt-c-content-color-first">
            雪中明月 の BLOG
        </div>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-bars gt-c-content-color-first" style="font-size: 18px"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
                <div class="nav-item">
                    
                        <a href="/" class="menu gt-a-link">
                            首页
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/archives" class="menu gt-a-link">
                            归档
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/tags" class="menu gt-a-link">
                            标签
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/post/about" class="menu gt-a-link">
                            关于
                        </a>
                    
                </div>
            
        </div>
        <div style="text-align: center">
            <form id="gridea-search-form" style="position: relative" data-update="1715590005923" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="搜索文章" />
                <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
        </div>
    </div>
</nav>

    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    MongoDB 与 Python Mongodb
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        · 2023-10-13 ·
                    </time>
                    
                        <a href="https://blog.xn--fiqz59cpva341l.top/tag/1eho6fu3a/" class="post-tags">
                            # python
                        </a>
                    
                        <a href="https://blog.xn--fiqz59cpva341l.top/tag/5o5paThRu/" class="post-tags">
                            # mongoDB
                        </a>
                    
                </div>
                <div class="post-content">
                    <p>本文章在windows环境，不探讨MongoDB Shell命令</p>
<!-- more -->
<h2 id="1-安装mongodb">1. 安装MongoDB</h2>
<p>这个官方DOC https://www.mongodb.com/docs/manual/introduction/</p>
<p>下载地址 https://www.mongodb.com/try/download/community</p>
<p>选择msi后缀的版本下载</p>
<p>直接无脑安装</p>
<h2 id="2-安装mongosh">2. 安装Mongosh</h2>
<p>MongoDB Shell（mongosh）未与MongoDB服务器一同安装。你需要按照mongosh的安装说明单独下载和安装<a href="https://www.mongodb.com/docs/mongodb-shell/">mongosh(点击查看)</a>。</p>
<p>下载完成后解压放入一个目录，例如C盘下，添加环境变量，记得加上<code>\bin</code>例如 <code>C:\mongosh-2.0.1-win32-x64\bin</code></p>
<p>在终端输入<code> mongosh</code>测试是否成功进入shell</p>
<blockquote>
<p><strong>在Navicat可视化查看:</strong></p>
<p>直接添加连接，选择MongoDB，信息默认就行（如果没改）</p>
</blockquote>
<h2 id="3-python中的使用">3. Python中的使用</h2>
<h3 id="31-安装包">3.1. 安装包</h3>
<p><code>pip install pymongo</code></p>
<h3 id="32-连接数据库的2方法">3.2. 连接数据库的2方法</h3>
<pre><code class="language-python">from pymongo.mongo_client import MongoClient

# 使用默认本地主机和端口（27017）创建连接
client = MongoClient('localhost', 27017)
</code></pre>
<pre><code class="language-python"># 或者，使用连接字符串连接到 MongoDB
s = &quot;mongodb://127.0.0.1:27017/?directConnection=true&amp;serverSelectionTimeoutMS=2000&amp;appName=mongosh+2.0.1&quot;
client = MongoClient(s)
</code></pre>
<blockquote>
<p>s 这字符串在哪获得？终端中进入mongosh时会显示，在<code>Connecting to:</code>后面</p>
</blockquote>
<h3 id="33-创建数据库和集合">3.3. 创建数据库和集合</h3>
<p>集合相当于表</p>
<pre><code class="language-python"># 创建数据库
mydb = client[&quot;my1stdb&quot;]
# 创建表
mytable = mydb[&quot;class&quot;]

</code></pre>
<p>此时数据库和集合还没真正创建，因为数据库和表是空的</p>
<h3 id="34-显示数据库-集合和数据">3.4. 显示数据库、集合和数据</h3>
<p><strong>显示数据库、集合</strong></p>
<pre><code class="language-python">print(
    client.list_database_names(),  # 显示数据库列表
    mydb.list_collection_names()	# 显示集合列表
)
</code></pre>
<p><strong>显示集合内容</strong></p>
<pre><code class="language-python">records = mytable.find()
for record in records:
    print(record)
# 不能直接打印 records
</code></pre>
<p><strong>此时看不到，完成 3.5 才能看到</strong></p>
<h3 id="35-添加数据">3.5. 添加数据</h3>
<p>添加单个记录</p>
<pre><code class="language-python">mytable.insert_one(
    # 输入是一个字典
    {&quot;name&quot;: &quot;xiaohei&quot;, &quot;age&quot;: &quot;18&quot;}
)
</code></pre>
<p>添加多个记录</p>
<pre><code class="language-python">mytable.insert_many(
    # 输入时一个字典列表
    [{&quot;name&quot;: &quot;xiaohong&quot;, &quot;age&quot;: &quot;18&quot;},
     {&quot;name&quot;: &quot;xiaolan&quot;, &quot;age&quot;: &quot;18&quot;}]
)
</code></pre>
<h3 id="36-删除集合和数据和数据库">3.6. 删除集合和数据和数据库</h3>
<p>删除一个（符合条件的第一个）</p>
<pre><code class="language-python">mytable.delete_one(
    {&quot;name&quot;: &quot;xiaohong&quot;}
)
</code></pre>
<p>删除全部</p>
<pre><code class="language-python">mytable.delete_many({})
</code></pre>
<p>删除多个（所有符合条件的）</p>
<pre><code class="language-pyhon">mytable.delete_many(
    {&quot;name&quot;: &quot;xiaohong&quot;, &quot;age&quot;: &quot;18&quot;}
)
# 传入的是一个字典，不是列表
# 可以使用正则表达式
mytable.delete_many(
    {&quot;name&quot;: {&quot;$regex&quot;: &quot;^xiao&quot;}}
    # 删除所有xiao开头的数据
)
</code></pre>
<p>删除集合</p>
<pre><code class="language-python">mydb = client[&quot;my1stdb&quot;]
mytable = mydb[&quot;class1&quot;]

# 第一种
mydb.drop_collection(&quot;class1&quot;)
# 第二种
mytable.drop()
</code></pre>
<p>删除数据库</p>
<pre><code class="language-python"># 第一种
client.drop_database(&quot;xxx&quot;)
# 第二种
mytable.drop()
</code></pre>
<h3 id="36-修改数据">3.6. 修改数据</h3>
<p>如下面格式</p>
<pre><code class="language-python"># mytable.update_one(
#     {&quot;查找&quot;},
#     {&quot;$set&quot;: &quot;改成什么&quot;}
# )


mytable.update_one(
    {&quot;name&quot;: &quot;xiaolan&quot;},
    {&quot;$set&quot;: {&quot;name&quot;: &quot;xiaobai&quot;}}
)
mytable.update_many(
    {&quot;name&quot;: &quot;xiaohong&quot;},
    {&quot;$set&quot;: {&quot;name&quot;: &quot;xiaolan&quot;}}
)
</code></pre>
<h3 id="37-查询数据">3.7. 查询数据</h3>
<p>查找一个</p>
<pre><code class="language-python">x = mytable.find_one(
    {&quot;age&quot;: &quot;14&quot;}
)
# {'_id': ObjectId('65297cce8b9a13e50784fe86'), 'name': 'xiaolu', 'age': '14'}
</code></pre>
<p>查找多个</p>
<pre><code class="language-python">x = mytable.find(
    {&quot;age&quot;: &quot;14&quot;}
)
# {'_id': ObjectId('65297d04b06c5d3a99ddc75b'), 'name': 'xiaolu', 'age': '14'}
# {'_id': ObjectId('65297d04b06c5d3a99ddc75d'), 'name': 'xiaolan', 'age': '14'}
</code></pre>
<p>自定义查找返回的结果</p>
<p><code>0</code>为<code>隐藏</code>，<code>1</code>为<code>显示</code>，<code>_id</code> 默认为 1</p>
<pre><code class="language-python">x = mytable.find(
    {},
    {&quot;_id&quot;: 0, &quot;name&quot;:1,&quot;age&quot;: 1}
)
# {'name': 'xiaohong', 'age': '18'}
# {'name': 'xiaobai', 'age': '20'}
# ...
</code></pre>
<p><strong>高级查找</strong></p>
<pre><code class="language-python">查找年龄大于14的学生
x = mytable.find(
    {&quot;age&quot;: {&quot;$gt&quot;: &quot;14&quot;}},
    {&quot;_id&quot;: 0, &quot;name&quot;: 1}
)

# {'name': 'xiaohong'}
# {'name': 'xiaobai'}
# {'name': 'xiaohei'}
# {'name': 'xiaozi'}
</code></pre>
<blockquote>
<p>使用<code>.limit()</code>来显示返回的答案的数量</p>
<pre><code class="language-python">x = mytable.find(
    {&quot;age&quot;: {&quot;$gt&quot;: &quot;14&quot;}},
    {&quot;_id&quot;: 0, &quot;name&quot;: 1}
).limit(2)

# {'name': 'xiaohong'}
# {'name': 'xiaobai'}
</code></pre>
</blockquote>
<p>以下是一些常用的<strong>修饰符条件</strong>：</p>
<ol>
<li>
<p><code>$gt</code>（大于）：用于匹配字段值大于指定值的文档。</p>
<pre><code class="language-python">collection.find({&quot;field_name&quot;: {&quot;$gt&quot;: value}})
</code></pre>
</li>
<li>
<p><code>$lt</code>（小于）：用于匹配字段值小于指定值的文档。</p>
<pre><code class="language-python">collection.find({&quot;field_name&quot;: {&quot;$lt&quot;: value}})
</code></pre>
</li>
<li>
<p><code>$gte</code>（大于等于）：用于匹配字段值大于等于指定值的文档。</p>
<pre><code class="language-python">collection.find({&quot;field_name&quot;: {&quot;$gte&quot;: value}})
</code></pre>
</li>
<li>
<p><code>$lte</code>（小于等于）：用于匹配字段值小于等于指定值的文档。</p>
<pre><code class="language-python">collection.find({&quot;field_name&quot;: {&quot;$lte&quot;: value}})
</code></pre>
</li>
<li>
<p><code>$ne</code>（不等于）：用于匹配字段值不等于指定值的文档。</p>
<pre><code class="language-python">collection.find({&quot;field_name&quot;: {&quot;$ne&quot;: value}})
</code></pre>
</li>
<li>
<p><code>$in</code>（包含于）：用于匹配字段值在指定列表中的文档。</p>
<pre><code class="language-python">collection.find({&quot;field_name&quot;: {&quot;$in&quot;: [value1, value2, value3]}})
</code></pre>
</li>
<li>
<p><code>$nin</code>（不包含于）：用于匹配字段值不在指定列表中的文档。</p>
<pre><code class="language-python">collection.find({&quot;field_name&quot;: {&quot;$nin&quot;: [value1, value2, value3]}})
</code></pre>
</li>
<li>
<p><code>$exists</code>（存在）：用于匹配具有指定字段的文档。</p>
<pre><code class="language-python">collection.find({&quot;field_name&quot;: {&quot;$exists&quot;: True}})
</code></pre>
</li>
<li>
<p><code>$type</code>（类型）：用于匹配字段的数据类型。</p>
<pre><code class="language-python">collection.find({&quot;field_name&quot;: {&quot;$type&quot;: data_type}})
</code></pre>
</li>
<li>
<p><code>$regex</code>（正则表达式）：用于执行正则表达式匹配。</p>
<pre><code class="language-python">collection.find({&quot;field_name&quot;: {&quot;$regex&quot;: &quot;pattern&quot;}})
</code></pre>
</li>
</ol>
<p>这些修饰符条件可用于创建各种查询，以满足你的数据筛选需求。你可以根据文档字段的值和数据类型来选择适当的修饰符条件。</p>

                </div>
            </article>
        </div>

        
            <div class="next-post">
                <div class="next gt-c-content-color-first">下一篇</div>
                <a href="https://blog.xn--fiqz59cpva341l.top/post/mapreduce-bian-cheng-huan-jing-pei-zhi/" class="post-title gt-a-link">
                    MapReduce 编程环境配置
                </a>
            </div>
        

        

        

        

        <div class="site-footer gt-c-content-color-first">
    <div class="slogan gt-c-content-color-first">唤取雪中明月，征服浩瀚世界！</div>
    <div class="social-container">
        
            
        
            
        
            
        
            
        
            
        
            
        
    </div>
    <div class="footer-info">
        Copyright © 2077  <a href="https://icp.gov.moe/?keyword=20230701" id="power-text">萌ICP备20230701号</a>
    </div>
    <div>
        Theme by <a href="https://imhanjie.com/" target="_blank">imhanjie</a>, Powered by <a
                href="https://github.com/getgridea/gridea" target="_blank">Gridea | <a href="https://blog.xn--fiqz59cpva341l.top/atom.xml" target="_blank">RSS</a></a>
    </div>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

    </div>
</div>
</body>
</html>
